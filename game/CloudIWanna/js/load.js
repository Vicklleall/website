function setVolume(r){oBGM.volume=2**r-1,localStorage.setItem('Volume',r),objAudio.vol.gain.setValueAtTime(r,objAudio.currentTime),r*=100,BGMVa.style.left=r+'%',BGMVb.style.backgroundImage=`linear-gradient(90deg,#e12828 ${r}%,transparent 0)`}scrn=$('screen'),scr=scrn.getContext('2d'),scr.imageSmoothingEnabled=!1,tiles=document.createElement('canvas'),tiles.width=scrn.width,tiles.height=scrn.height,$('surface').insertBefore(tiles,scrn),scrT=tiles.getContext('2d'),scrT.imageSmoothingEnabled=!1,colSF=document.createElement('canvas'),colSF.width=832,colSF.height=640,colsf=colSF.getContext('2d'),colsf.imageSmoothingEnabled=!1,scref=document.createElement('canvas'),scref.width=800,scref.height=608,sfscr=scref.getContext('2d'),sfscr.imageSmoothingEnabled=!1,GUI=$('GUI'),GO=$('GO'),GC=$('GC'),Bd=$('Bd'),GCobj=GC.children,EF=[],$('WYY').onclick=()=>{if(BGMid.value){var r=document.createElement('a');r.style.display='none',r.target='_blank',r.href='https://music.163.com/#/song?id='+BGMid.value,document.body.appendChild(r),r.click(),document.body.removeChild(r)}},BGMplay=$('BGMplay'),BGMplay.onclick=function(){oBGM.paused?(oBGM.play(),this.style.backgroundImage='url(//cdn.jsdelivr.net/gh/vicklleall/website@g3dyb/game/CloudIWanna/img/pause.png)'):(oBGM.pause(),this.style.backgroundImage='url(//cdn.jsdelivr.net/gh/vicklleall/website@g3dyb/game/CloudIWanna/img/play.png)')},BGMBox=$('BGMBox'),oBGM=$('BGM'),oBGM.loop=!0,BGMVa=$('BGMVa'),BGMVb=$('BGMVb'),oBGM.onerror=function(r){this.pause(),BGMplay.style.backgroundImage='url(//cdn.jsdelivr.net/gh/vicklleall/website@g3dyb/game/CloudIWanna/img/play.png)',console.log(r),edit&&alert('音乐载入出错！')},BGMVa.onmousedown=function(r){this.on=!0,this.dX=r.clientX-this.offsetLeft},BGMBox.onmousemove=r=>{BGMVa.on&&setVolume(Math.min(Math.max(0,r.clientX-BGMVa.dX)/BGMVb.offsetWidth,1))},BGMBox.onmouseup=()=>{BGMVa.on=!1},BGMBox.onmouseleave=BGMBox.onmouseup,AudioContext=AudioContext||webkitAudioContext,objAudio=new AudioContext,objAudio.vol=objAudio.createGain(),objAudio.vol.connect(objAudio.destination),null!==localStorage.getItem('Volume')?setVolume(Number(localStorage.getItem('Volume'))):setVolume(.5);const LOAD=()=>{sndJump=loadAudio('sndJump.ogg'),sndShoot=loadAudio('sndShoot.ogg'),sndDeath=loadAudio('sndDeath.ogg'),sndWallJump=loadAudio('sndWallJump.ogg'),sndExtraJump=null,sndGainJump=null,sndLoseJump=null,sndSpring=null,sndBreak=null,sprPlayerStart=[loadSpr('sprPlayerStart')],sprRCherry=[loadSpr('sprRCherry')],sprShooter=[loadSpr('sprShooter1'),loadSpr('sprShooter2'),loadSpr('sprShooter3'),loadSpr('sprShooter4'),loadSpr('sprShooter5')],sprSG=[loadSpr('sprSG')],sprSJump=[loadSpr('sprSJump')],sprDJump=[loadSpr('sprDJump')],sprTJump=[loadSpr('sprTJump')],sprIJump=[loadSpr('sprIJump')],sprPStar=[loadSpr('sprPStar')],sprLGrav=[loadSpr('sprLGrav')],sprHGrav=[loadSpr('sprHGrav')],sprFSpd=[loadSpr('sprFSpd')],sprSSpd=[loadSpr('sprSSpd')],sprTrigger=[loadSpr('sprTrigger')],sprPt=[loadSpr('ptCloud'),loadSpr('ptSmoke'),loadSpr('ptSnow')],sprFake=[loadSpr('sprFBlock'),loadSpr('sprFPf')]};function sndInit(r){window[r]||(window[r]=loadAudio(r+'.ogg'))}function loadAudio(r){var e={},s=new XMLHttpRequest;return s.responseType='arraybuffer',s.open('GET','//cdn.jsdelivr.net/gh/vicklleall/website@g3dyb/game/CloudIWanna/snd/'+r,!0),s.onload=()=>{objAudio.decodeAudioData(s.response,r=>{e.src=r},r=>{console.log(r)})},s.send(),e}function sndPlay(r,e){r.snd=objAudio.createBufferSource(),r.snd.buffer=r.src,e&&(r.snd.playbackRate.value=e),r.snd.connect(objAudio.vol),r.snd.start(0)}function loadSpr(r,e="",s){var a=new Image;if(a.src='//cdn.jsdelivr.net/gh/vicklleall/website@g3dyb/game/CloudIWanna/img/spr/'+e+r+'.png',a.crossOrigin='',s){var o=document.createElement('canvas');o.src=a.src}return a.onload=function(){if(s){o.width=this.width,o.height=this.height;let r=o.getContext('2d');r.drawImage(this,0,0),r.globalCompositeOperation='source-in',r.fillStyle=s,r.fillRect(0,0,o.width,o.height),this.src.includes('Conveyor')&&(fillCoveyor=scr.createPattern(o,'repeat-x'))}else this.src.includes('Conveyor')?fillCoveyor=scr.createPattern(this,'repeat-x'):this.src.includes('sprLGrav')?fillLGrav=scr.createPattern(this,'repeat'):this.src.includes('sprHGrav')?fillHGrav=scr.createPattern(this,'repeat'):this.src.includes('sprSSpd')?fillSSpd=scr.createPattern(this,'repeat'):this.src.includes('sprFSpd')&&(fillFSpd=scr.createPattern(this,'repeat'));loadCount+=1,Loading.innerHTML=`<pre>Loading...\n${(loadCount/sprNumber*100).toFixed(0)}%</pre>`},a.onerror=function(){'sprFloor'===r?(r='sprBlock',this.src='//cdn.jsdelivr.net/gh/vicklleall/website@g3dyb/game/CloudIWanna/img/spr/'+e+r+'.png'):this.er||(this.src='//cdn.jsdelivr.net/gh/vicklleall/website@g3dyb/game/CloudIWanna/img/spr/'+r+'.png',this.er=!0)},s?o:a}function loadSkin(r,e){for(var s=0;s<Sprites.length;s++){var a=Sprites[s],o=e&&e[s],p=Number(a.charAt(a.length-1));if(p){a=a.slice(0,-1),window[a]?window[a].splice(0):window[a]=[];for(let e=1;e<=p;e++){let p=a+e;window[a].push(loadSpr(p,r[s],o))}}else window[a]?window[a][0]=loadSpr(a,r[s],o):window[a]=[loadSpr(a,r[s],o)]}}function setSprCol(r,e,s){var a=Array.from(Sprites,s=>{switch(s){case'sprWallJump':case'sprConveyor':case'sprJR':return e}return r});loadSkin(AllTheme[s],a)}function setColSpr(r,e){var s=document.createElement('canvas');s.width=r.width,s.height=r.height,s.src=r.src;var a=s.getContext('2d');return a.drawImage(r,0,0),a.globalCompositeOperation='source-in',a.fillStyle=e,a.fillRect(0,0,s.width,s.height),s}Sprites=['sprBlock','sprFloor','sprSpike','sprPlatform','sprWater','sprBlood3','sprBullet2','sprSave2','sprCherry2','sprPlayerIdle4','sprPlayerRun4','sprPlayerJump2','sprPlayerFall2','sprPlayerSlide2','sprWallJump','sprJR','sprCrate','sprWarp','sprIce','sprSpring2','sprBoard','sprTp','sprConveyor','sprBBlock'],loadCount=0,Loading=$('loading'),sprNumber=62,AllTheme=[],AllTheme[2]=Array.from(Sprites,r=>{switch(r){case'sprWarp':case'sprSave2':case'sprCherry2':case'sprCrate':case'sprJR':case'sprPlatform':case'sprSpring2':case'sprBoard':case'sprConveyor':case'sprBBlock':return'RMJ/'}return''}),AllTheme[3]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprWarp':case'sprConveyor':case'sprFloor':case'sprPlatform':case'sprSave2':case'sprCrate':case'sprJR':return'NANG/'}return''}),AllTheme[4]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':case'sprIce':return'Guy01/'}return''}),AllTheme[5]=Array.from(Sprites,r=>{switch(r){case'sprSpike':return'Guy01/';case'sprBlock':case'sprFloor':return'Guy02/'}return''}),AllTheme[6]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':case'sprCherry2':case'sprPlatform':case'sprWarp':return'K3S5/'}return''}),AllTheme[7]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':case'sprPlatform':case'sprJR':case'sprPlayerIdle4':case'sprPlayerRun4':case'sprPlayerJump2':case'sprPlayerFall2':case'sprPlayerSlide2':return'Crimson/'}return''}),AllTheme[8]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':case'sprWater':case'sprWallJump':case'sprBullet2':case'sprCherry2':case'sprPlatform':case'sprSave2':case'sprCrate':return'Darejar/'}return''}),AllTheme[9]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':case'sprPlatform':case'sprWallJump':case'sprWarp':case'sprSave2':case'sprCrate':case'sprJR':case'sprWater':case'sprCherry2':case'sprBoard':return'Adventure/'}return''}),AllTheme[10]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprFloor':case'sprPlatform':return'Hanamogeta/';case'sprSpike':case'sprWater':case'sprWallJump':case'sprBullet2':case'sprCherry2':case'sprSave2':case'sprCrate':return'Darejar/'}return''}),AllTheme[11]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprFloor':case'sprPlatform':case'sprSpike':return'Shadowlink57/'}return''}),AllTheme[12]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':case'sprWater':case'sprCherry2':case'sprPlatform':case'sprSave2':case'sprCrate':case'sprConveyor':case'sprSpring2':return'Hibikusuku/'}return''}),AllTheme[13]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprFloor':case'sprCherry2':case'sprWater':case'sprCrate':return'Kamirin/';case'sprSpike':return'K3S5/'}return''}),AllTheme[14]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprFloor':case'sprSpike':case'sprSave2':case'sprPlatform':case'sprWater':case'sprWarp':case'sprBoard':case'sprWallJump':case'sprJR':return'MELTDOWN/';case'sprCherry2':case'sprCrate':return'Kamirin/'}return''}),AllTheme[15]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':case'sprPlatform':return'NANGS8/';case'sprWarp':case'sprPlatform':case'sprSave2':case'sprCrate':case'sprJR':return'NANG/'}return''}),AllTheme[16]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':return'uhuhu3/'}return''}),AllTheme[17]=Array.from(Sprites,r=>{switch(r){case'sprBlock':case'sprSpike':case'sprFloor':case'sprSave2':return'Midnight/';case'sprCherry2':return'K3S5/'}return''}),AllTheme[0]=Array.from(Sprites,r=>{switch(r){case'sprSave2':case'sprWater':case'sprCrate':case'sprJR':case'sprBBlock':return'Color/';case'sprBoard':return'RMJ/'}return''}),AllTheme[1]=Array.from(Sprites,r=>{switch(r){case'sprWater':return'Color/';case'sprBlood3':case'sprBullet2':case'sprWallJump':return''}return'Line/'});